!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.GameCanvas=e():t.GameCanvas=e()}(this,()=>(()=>{"use strict";var t={d:(e,i)=>{for(var s in i)t.o(i,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>i});class i{constructor(t={}){if(t.hasOwnProperty("elementID")){if(null==(e=document.getElementById(t.elementID)))throw Error("No element with the id '"+t.elementID+"' was found!");if(!(e instanceof HTMLCanvasElement))throw Error("Element is not a canvas!");this.canvas=e}else if(t.hasOwnProperty("elementClass")){if(null==(e=document.getElementsByClassName(t.elementClass)[0]))throw Error("No element with the class '"+t.elementClass+"' was found!");if(!(e instanceof HTMLCanvasElement))throw Error("Element is not a canvas!");this.canvas=e}else if(t.hasOwnProperty("element")){var e;if(null==(e=t.element))throw Error("Element is null or undefined!");if(!(e instanceof HTMLCanvasElement))throw Error("Element '"+e+"' is not a canvas!");this.canvas=e}else this.canvas=document.createElement("canvas"),document.body.appendChild(this.canvas);if(t.hasOwnProperty("width")){if(isNaN(t.width))throw Error("Width is not a number: "+t.width);this.canvas.width=t.width}if(t.hasOwnProperty("height")){if(isNaN(t.height))throw Error("Height is not a number: "+t.height);this.canvas.height=t.height}if(t.hasOwnProperty("width")||t.hasOwnProperty("height")||t.hasOwnProperty("noFullscreen")&&(!t.hasOwnProperty("noFullscreen")||t.noFullscreen)?(this.disableContextMenu=!!t.hasOwnProperty("disableContextMenu")&&t.disableContextMenu,this.disableMiddleMouse=!!t.hasOwnProperty("disableMiddleMouse")&&t.disableMiddleMouse,this.disableScrollOnMobile=!!t.hasOwnProperty("disableScrollOnMobile")&&t.disableScrollOnMobile,this.disableKeyShortcuts=!!t.hasOwnProperty("disableKeyShortcuts")&&t.disableKeyShortcuts,this.updateCanvasSizeOnResize=!!t.hasOwnProperty("updateCanvasSizeOnResize")&&t.updateCanvasSizeOnResize,this.publicMethods=!t.hasOwnProperty("publicMethods")||t.publicMethods):(this.canvas.width=Math.ceil(window.innerWidth)+1,this.canvas.height=Math.ceil(window.innerHeight)+1,this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.bottom="0",this.canvas.style.left="0",this.canvas.style.right="0",document.body.style.overflow="hidden",this.disableContextMenu=!t.hasOwnProperty("disableContextMenu")||t.disableContextMenu,this.disableMiddleMouse=!t.hasOwnProperty("disableMiddleMouse")||t.disableMiddleMouse,this.disableScrollOnMobile=!t.hasOwnProperty("disableScrollOnMobile")||t.disableScrollOnMobile,this.disableKeyShortcuts=!!t.hasOwnProperty("disableKeyShortcuts")&&t.disableKeyShortcuts,this.updateCanvasSizeOnResize=!t.hasOwnProperty("updateCanvasSizeOnResize")||t.updateCanvasSizeOnResize,this.publicMethods=!t.hasOwnProperty("publicMethods")||t.publicMethods),this.ctx=this.canvas.getContext("2d"),this.font="Arial",this.images=[],this.imageData=void 0,this.imageDataData=void 0,this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.keys={keysDown:[],ctrlPressed:!1,shiftSPressed:!1,altPressed:!1},this.mouse={x:0,y:0,lastX:0,lastY:0,movementX:0,movementY:0,left:!1,right:!1,middle:!1,any:!1},this.mouseLookupTable=["left","middle","right"],this.touch={x:0,y:0,isTouching:!1,nrTouches:0,touches:[]},this.eventFunctions={mousedown:"undefined"!=typeof OnMouseDown,mouseup:"undefined"!=typeof OnMouseUp,mousemove:"undefined"!=typeof OnMouseMove,contextmenu:"undefined"!=typeof OnContextMenu,touchstart:"undefined"!=typeof OnTouchStart,touchend:"undefined"!=typeof OnTouchEnd,touchmove:"undefined"!=typeof OnTouchMove,keydown:"undefined"!=typeof OnKeyDown,keyup:"undefined"!=typeof OnKeyUp,resize:"undefined"!=typeof OnResize},this.ENUM={LINECAP:{DEFAULT:"butt",BUTT:"butt",ROUND:"round",SQUARE:"square"},TEXTALIGN:{X:{DEFAULT:"start",START:"start",END:"end",CENTER:"center",LEFT:"left",RIGHT:"right"},Y:{DEFAULT:"alphabetic",ALPHABETIC:"alphabetic",TOP:"top",HANGING:"hanging",MIDDLE:"middle",CENTER:"middle",IDEOGRAPHIC:"ideographic",BOTTOM:"bottom"}}},document.addEventListener("keydown",t=>{if(this.keys.altPressed=t.altKey,this.keys.shiftPressed=t.shiftKey,this.keys.ctrlPressed=t.ctrlKey,this.keys.keysDown[t.key]=this.keys.keysDown[t.keyCode]=this.keys.keysDown[t.code]=!0,this.eventFunctions.keydown&&OnKeyDown(t),this.disableKeyShortcuts)return t.preventDefault(),!1}),document.addEventListener("keyup",t=>{this.keys.altPressed=t.altKey,this.keys.shiftPressed=t.shiftKey,this.keys.ctrlPressed=t.ctrlKey,this.keys.keysDown[t.key]=this.keys.keysDown[t.keyCode]=this.keys.keysDown[t.code]=!1,this.eventFunctions.keyup&&OnKeyUp(t)}),this.canvas.addEventListener("mousemove",t=>{let e=this.canvas.getBoundingClientRect();this.mouse.x=(t.clientX-e.left)/(e.width/this.width),this.mouse.y=(t.clientY-e.top)/(e.height/this.height),this.mouse.movementX=t.movementX,this.mouse.movementY=t.movementY,this.eventFunctions.mousemove&&OnMouseMove(t)}),this.canvas.addEventListener("mousedown",t=>{let e=t.button;if(e<3&&(this.mouse[this.mouseLookupTable[e]]=!0),this.mouse.any=this.mouse.left||this.mouse.right||this.mouse.middle,this.eventFunctions.mousedown&&OnMouseDown(t),1==e&&this.disableMiddleMouse)return t.preventDefault(),!1}),this.canvas.addEventListener("mouseup",t=>{let e=t.button;e<3&&(this.mouse[this.mouseLookupTable[e]]=!1),this.mouse.any=this.mouse.left||this.mouse.right||this.mouse.middle||this.touch.touches.length>0,this.eventFunctions.mouseup&&OnMouseUp(t)}),this.canvas.addEventListener("contextmenu",t=>(this.eventFunctions.contextmenu&&OnContextMenu(t),!this.disableContextMenu||(t.preventDefault(),!1))),this.updateTouches=function(t){let e=this.canvas.getBoundingClientRect();this.touch.touches=[];for(let a=0;a<t.touches.length;a++){var i=t.touches[a],s=(i.pageX-e.left)/(e.width/this.width),n=(i.pageY-e.top)/(e.height/this.height);this.touch.touches[a]={x:s,y:n,id:i.identifier,force:i.force,radiusX:i.radiusX,radiusY:i.radiusY,rotationAngle:i.rotationAngle}}},this.canvas.addEventListener("touchmove",t=>{this.disableScrollOnMobile&&t.preventDefault(),this.updateTouches(t),this.touch.x=this.touch.touches[0].x,this.touch.y=this.touch.touches[0].y,this.eventFunctions.touchmove&&OnTouchMove(t)}),this.canvas.addEventListener("touchstart",t=>{this.disableScrollOnMobile&&t.preventDefault(),this.updateTouches(t),this.touch.x=this.touch.touches[0].x,this.touch.y=this.touch.touches[0].y,this.touch.isTouching=!0,this.mouse.any=!0,this.eventFunctions.touchstart&&OnTouchStart(t)}),this.canvas.addEventListener("touchend",t=>{this.disableScrollOnMobile&&t.preventDefault(),this.updateTouches(t),this.touch.isTouching=this.touch.touches.length>0,this.mouse.any=this.mouse.left||this.mouse.right||this.mouse.middle||this.touch.touches.length>0,this.eventFunctions.touchend&&OnTouchEnd(t)}),window.addEventListener("resize",t=>{this.updateCanvasSizeOnResize&&(this.width=Math.ceil(window.innerWidth)+1,this.height=Math.ceil(window.innerHeight)+1),this.eventFunctions.resize&&OnResize(t)}),this.isPassed=function(t){return void 0!==t},this.publicMethods){var s=Object.getOwnPropertyNames(i.prototype);for(var n of s)["constructor","width","height"].includes(n)||(window[n]=this[n].bind(this));for(var a of["width","height"])Object.defineProperty(window,a,{get:function(t,e){return function(){return t[e]}}(this,a),set:function(t,e){return function(i){t[e]=i}}(this,a),configurable:!0});for(var o of["mouse","touch"])Object.defineProperty(window,o,{get:function(t,e){return function(){return t[e]}}(this,o),configurable:!0})}}get width(){return this.canvas.width}get height(){return this.canvas.height}set width(t){this.canvas.width=t}set height(t){this.canvas.height=t}requestFullscreen(){this.canvas.requestFullscreen?this.canvas.requestFullscreen():this.canvas.mozRequestFullScreen?this.canvas.mozRequestFullScreen():this.canvas.webkitRequestFullscreen?this.canvas.webkitRequestFullscreen():this.canvas.msRequestFullscreen&&this.canvas.msRequestFullscreen()}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}lockPointer(){this.canvas.requestPointerLock=this.canvas.requestPointerLock||this.canvas.mozRequestPointerLock,this.canvas.requestPointerLock()}unlockPointer(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock,document.exitPointerLock()}clearScreen(){this.ctx.clearRect(0,0,this.width,this.height)}background(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.width,this.height)}arc(t,e,i,s,n,a){this.ctx.arc(t,e,i,s,n,a)}circle(t,e,i,s,n,a){this.ctx.beginPath(),this.ctx.arc(t,e,i,0,2*Math.PI),this.ctx.fillStyle=s,n&&(this.ctx.strokeStyle=n),a&&(this.ctx.lineWidth=a),this.ctx.fill(),n&&this.ctx.stroke()}ring(t,e,i,s,n){this.ctx.beginPath(),this.ctx.arc(t,e,i,0,2*Math.PI),this.ctx.strokeStyle=s,n&&(this.ctx.lineWidth=n),this.ctx.stroke()}ellipse(t,e,i,s,n,a=0,o,h){this.ctx.beginPath(),this.ctx.ellipse(t,e,i,s,a,0,2*Math.PI),this.ctx.fillStyle=n,o&&(this.ctx.strokeStyle=o),h&&(this.ctx.lineWidth=h),this.ctx.fill(),o&&this.ctx.stroke()}rectangle(t,e,i,s,n,a,o){n&&(this.ctx.fillStyle=n),o&&(this.ctx.lineWidth=o),a?(this.ctx.beginPath(),this.ctx.strokeStyle=a,this.ctx.rect(t,e,i,s),n&&this.ctx.fill(),this.ctx.stroke()):this.ctx.fillRect(t,e,i,s)}roundedRectangle(t,e,i,s,n,a,o,h){"number"==typeof a&&(a=[a,a,a,a]),this.ctx.beginPath(),this.ctx.arc(t+a[0],e+a[0],a[0],Math.PI,1.5*Math.PI),this.ctx.lineTo(t+i-a[1],e),this.ctx.arc(t+i-a[1],e+a[1],a[1],1.5*Math.PI,2*Math.PI),this.ctx.lineTo(t+i,e+s-a[2]),this.ctx.arc(t+i-a[2],e+s-a[2],a[2],0,.5*Math.PI),this.ctx.lineTo(t+a[3],e+s),this.ctx.arc(t+a[3],e+s-a[3],a[3],.5*Math.PI,Math.PI),this.ctx.closePath(),o&&(h&&(this.ctx.lineWidth=h),this.ctx.strokeStyle=o,this.ctx.stroke()),this.ctx.fillStyle=n,this.ctx.fill()}triangle(t,e,i,s,n,a,o,h,r){this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,s),this.ctx.lineTo(n,a),this.ctx.closePath(),this.ctx.fillStyle=o,r&&(this.ctx.lineWidth=r),this.ctx.fill(),h&&(this.ctx.strokeStyle=h,this.ctx.stroke())}line(t,e,i,s,n,a){this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,s),n&&(this.ctx.strokeStyle=n),a&&(this.ctx.lineWidth=a),this.ctx.stroke()}clippedPicture(t,e,i,s,n,a,o,h,r){var c=this.images[t];if(c)c.complete&&0!==c.naturalWidth&&(h=h||c.width,r=r||c.height,this.ctx.drawImage(c,e,i,s,n,a,o,h,r));else{var l=new Image;l.src=t,l.onload=()=>{h=h||l.width,r=r||l.height,this.ctx.drawImage(l,e,i,s,n,a,o,h,r)},this.images[t]=l}}picture(t,e,i,s,n){var a=this.images[t];if(a)a.complete&&(s=s||a.width,n=n||a.height,this.ctx.drawImage(a,e,i,s,n));else{var o=new Image;o.src=t,o.onload=()=>{s=s||o.width,n=n||o.height,this.ctx.drawImage(o,e,i,s,n)},this.images[t]=o}}text(t,e,i,s,n,a,o){this.ctx.beginPath(),this.ctx.font=s+"px "+this.font,this.ctx.fillStyle=n,o&&(this.ctx.lineWidth=o),this.ctx.fillText(t,e,i),a&&(this.ctx.strokeStyle=a,this.ctx.strokeText(t,e,i))}drawVector(t,e,i,s=1,n="black"){var a=this.normalizeVector(i),o=-a.y,h=a.x,r=t+a.x*s,c=e+a.y*s;this.line(t,e,r,c,3,n),this.triangle(r,c,r-7*a.x+7*o,c-7*a.y+7*h,r-7*a.x-7*o,c-7*a.y-7*h,n)}polygon(t,e,i,s,n,a,o){this.ctx.beginPath(),this.ctx.moveTo(t[0].x+e,t[0].y+i);for(var h=1;h<t.length;h++){var r=t[h];this.ctx.lineTo(r.x+e,r.y+i)}s&&this.ctx.closePath(),n&&(this.ctx.fillStyle=n,this.ctx.fill()),a&&(o&&(this.ctx.lineWidth=o),this.ctx.strokeStyle=a,this.ctx.stroke())}rgb(t=0,e=0,i=0){return`rgb(${t}, ${e}, ${i})`}getPixelData(){this.imageData=this.ctx.getImageData(0,0,this.width,this.height),this.imageDataData=this.imageData.data}updatePixel(t,e,i,s,n,a=255){let o=4*(t+e*this.width);this.imageDataData[o]=i,this.imageDataData[o+1]=s,this.imageDataData[o+2]=n,this.imageDataData[o+3]=a}updatePixelIndex(t,e,i,s,n=255){var a=4*t;this.imageDataData[a]=e,this.imageDataData[a+1]=i,this.imageDataData[a+2]=s,this.imageDataData[a+3]=n}getPixel(t,e){let i=4*(t+e*this.width);return[this.imageDataData[i],this.imageDataData[i+1],this.imageDataData[i+2],this.imageDataData[i+3]]}getPixelIndex(t){let e=4*t;return[this.imageDataData[e],this.imageDataData[e+1],this.imageDataData[e+2],this.imageDataData[e+3]]}renderPixelData(){this.ctx.putImageData(this.imageData,0,0)}save(){this.ctx.save()}restore(){this.ctx.restore()}rotate(t){this.ctx.rotate(t)}translate(t,e){this.ctx.translate(t,e)}beginPath(){this.ctx.beginPath()}closePath(){this.ctx.closePath()}moveTo(t,e){this.ctx.moveTo(t,e)}lineTo(t,e){this.ctx.lineTo(t,e)}quadraticCurveTo(t,e,i,s){this.ctx.quadraticCurveTo(t,e,i,s)}quadraticTo(t,e,i,s){this.ctx.quadraticCurveTo(t,e,i,s)}bezierCurveTo(t,e,i,s,n,a){this.ctx.bezierCurveTo(t,e,i,s,n,a)}bezierTo(t,e,i,s,n,a){this.ctx.bezierCurveTo(t,e,i,s,n,a)}fill(){this.ctx.fill()}stroke(){this.ctx.stroke()}fillStyle(t){this.ctx.fillStyle=t}strokeStyle(t){this.ctx.strokeStyle=t}setLineWidth(t){this.ctx.lineWidth=t}lineWidth(t){this.ctx.lineWidth=t}strokeWeight(t){this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=t}resetLineCap(){this.ctx.lineCap="butt"}setFont(t){this.font=t}setTextAlign(t){this.ctx.textAlign=t}setTextXAlign(t){this.ctx.textAlign=t}setTextAlignX(t){this.ctx.textAlign=t}setTextYAlign(t){this.ctx.textBaseline=t}setTextAlignY(t){this.ctx.textBaseline=t}resetTextXAlign(){this.ctx.textAlign="left"}resetTextAlignX(){this.ctx.textAlign="left"}resetTextYAlign(){this.ctx.textBaseline="alphabetic"}resetTextAlignY(){this.ctx.textBaseline="alphabetic"}clip(){this.ctx.clip()}createSound(t,e=1,i=0,s=!1){var n=new Audio(t);return n.loop=s,n.currentTime=i,n.volume=e,{volume:e,startTime:i,audio:n}}playSound(t){t.audio.currentTime=t.startTime,t.audio.volume=t.volume,t.audio.play()}stopSound(t){t.audio.stop()}pauseSound(t){t.audio.pause()}backgroundMusic(t){var e=new Audio(t);return e.loop=!0,e.play(),e}fadeOutSound(t,e=1){var i=t.volume,s=0,n=setInterval(()=>{t.audio.volume=i/(20*e)*(20*e-s),++s>20*e&&(t.audio.pause(),clearInterval(n))},50)}playTone(t=440,e=1,i=1,s="sine"){var n=this.audioContext.createOscillator(),a=this.audioContext.createGain();a.gain.value=i,a.connect(this.audioContext.destination),n.type=s,n.frequency.value=t,n.connect(a),n.start(),setTimeout(()=>{n.stop()},1e3*e)}getDistanceSqr(t,e,i,s){var n=t-i,a=e-s;return n*n+a*a}getDistanceSqr3D(t,e,i,s,n,a){var o=t-i,h=e-s,r=n-a;return o*o+h*h+r*r}getDistance(t,e,i,s){return Math.sqrt(top.getDistanceSqr(t,e,i,s))}getDistance3D(t,e,i,s,n,a){return Math.sqrt(top.getDistanceSqr3D(t,e,i,s,n,a))}getAngle(t,e,i,s){return Math.atan2(s-e,i-t)}normalize(t,e){var i=Math.sqrt(t*t+e*e);return{x:t/i,y:e/i}}normalizeVector(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return{x:t.x/e,y:t.y/e}}normalize3D(t,e,i){var s=Math.sqrt(t*t+e*e+i*i);return{x:t/s,y:e/s,z:i/s}}normalize3DVector(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);return{x:t.x/e,y:t.y/e,z:t.z/e}}lengthVector(t){return Math.sqrt(t.x*t.x+t.y*t.y)}length3DVector(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)}dot(t,e){return t.x*e.x+t.y*e.y}dot3D(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}crossProduct3D(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}}clamp(t,e,i){return Math.max(e,Math.min(i,t))}lerp(t,e,i){return t*(1-i)+e*i}rectanglesIntersect(t,e,i,s,n,a,o,h){return t+i>n&&t<n+o&&e+s>a&&e<a+h}circlesIntersect(t,e,i,s,n,a){return this.getDistance(t,e,s,n)<i+a}circleRectangleIntersect(t,e,i,s,n,a,o){var h=Math.abs(t-(s+a/2)),r=Math.abs(e-(n+o/2));if(h>a/2+i)return!1;if(r>o/2+i)return!1;if(h<=a/2)return!0;if(r<=o/2)return!0;var c=h-a/2,l=r-o/2;return c*c+l*l<=i*i}random(t){return Math.random()*t}randomInt(t){return Math.random()*t|0}randomArray(t){return t[Math.floor(Math.random()*t.length)]}randomColor(t){if("number"!=typeof t||isNaN(t))return"rgb("+(256*Math.random()|0)+","+(256*Math.random()|0)+","+(256*Math.random()|0)+")";if(0===t)throw Error("Colordepth cannot be 0");var e=256/t;return"rgb("+Math.ceil(Math.floor(256*Math.random())/e)*e+","+Math.ceil(Math.floor(256*Math.random())/e)*e+","+Math.ceil(Math.floor(256*Math.random())/e)*e+")"}canvasToURL(){return top.canvas.toDataURL()}canvasToImage(){var t=new Image;return t.src=top.canvas.toDataURL(),t}saveToFile(t="canvas.png"){var e=document.createElement("a");e.download=t,e.href=top.canvas.toDataURL(),e.click()}setCookie(t,e,i=36500){let s=new Date;s.setTime(s.getTime()+24*i*60*60*1e3);let n="expires="+s.toUTCString();document.cookie=t+"="+e+";"+n+";path=/"}getCookie(t){if(0==t.length)return!1;var e=t+"=",i=document.cookie.split(";");for(let t=0;t<i.length;t++){let n=i[t];var s=n.indexOf(e);if(s>0)return n.substr(s+e.length)}return!1}deleteCookie(t){document.cookie=t+"=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/"}isCtrlPressed(){return this.keys.ctrlPressed}isAltPressed(){return this.keys.AltPressed}isShiftPressed(){return this.keys.shiftPressed}key(t){return!!this.keys.keysDown[t]}create2DArray(t,e,i=(t,e)=>0){for(var s=new Array(t),n=0;n<t;n++){s[n]=new Array(e);for(var a=0;a<e;a++)s[n][a]=i(n,a)}return s}mapValue(t,e,i,s,n){return(t-e)*(n-s)/(i-e)+s}gradient(t,e,i,s,n,a){var o=this.ctx.createLinearGradient(i,s,n,a);return o.addColorStop(0,t),o.addColorStop(1,e),o}prettyprint(t){"object"==typeof t&&console.log(JSON.stringify(t,null,2))}}return e.default})());